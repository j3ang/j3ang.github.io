[{"single":{"id":14,"date":"2021-01-09T06:47:10","date_gmt":"2021-01-09T06:47:10","guid":{"rendered":"http://localhost:3080/?p=14"},"modified":"2021-01-09T19:09:04","modified_gmt":"2021-01-09T19:09:04","slug":"sql-window-function-running-total","status":"publish","type":"post","link":"http://localhost:3080/sql-window-function-running-total/","title":{"rendered":"SQL window function / running total"},"content":{"rendered":"<p>This is a inner join.<br />\nWe will need to add two conditions.<br />\none to get each day record and all next days records.</p>\n<p><!--more--></p>\n<pre><code>DROP TABLE IF EXISTS `nytimes_covid_counties_day_seq`;\n\nCREATE TABLE `nytimes_covid_counties_day_seq`\nAS\nSELECT a.state, a.`date`, a.cases, COUNT(*) seq\n  FROM nytimes_covid_states a, nytimes_covid_states b\n WHERE a.state = b.state\n   AND a.`date` &gt;= b.`date`\n GROUP BY a.state, a.`date`, a.cases</code></pre>\n<p>Another way of doing this is using the window functions.</p>\n<pre><code>DROP TABLE IF EXISTS `nytimes_covid_states_day_seq`;\nCREATE TABLE `nytimes_covid_states_day_seq`\nAS\nSELECT *, RANK() OVER( PARTITION BY `state` ORDER BY `date`) AS seq\nFROM `nytimes_covid_states`;</code></pre>\n<p><img src=\"https://j3ang-uploads.storage.googleapis.com/wp-content/uploads/2021/01/09190522/post-14-5ff9fe379063a.png\" alt=\"window_sql_output\" /></p>\n","protected":false},"excerpt":{"rendered":"<p>This is a inner join. We will need to add two conditions. one to get each day record and all next days records.</p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[9],"tags":[11,10],"_links":{"self":[{"href":"http://localhost:3080/wp-json/wp/v2/posts/14"}],"collection":[{"href":"http://localhost:3080/wp-json/wp/v2/posts"}],"about":[{"href":"http://localhost:3080/wp-json/wp/v2/types/post"}],"author":[{"embeddable":true,"href":"http://localhost:3080/wp-json/wp/v2/users/1"}],"replies":[{"embeddable":true,"href":"http://localhost:3080/wp-json/wp/v2/comments?post=14"}],"version-history":[{"count":4,"href":"http://localhost:3080/wp-json/wp/v2/posts/14/revisions"}],"predecessor-version":[{"id":34,"href":"http://localhost:3080/wp-json/wp/v2/posts/14/revisions/34"}],"wp:attachment":[{"href":"http://localhost:3080/wp-json/wp/v2/media?parent=14"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http://localhost:3080/wp-json/wp/v2/categories?post=14"},{"taxonomy":"post_tag","embeddable":true,"href":"http://localhost:3080/wp-json/wp/v2/tags?post=14"}],"curies":[{"name":"wp","href":"https://api.w.org/{rel}","templated":true}]}}}]